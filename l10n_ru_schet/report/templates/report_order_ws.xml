<?xml version="1.0" encoding="utf-8" ?>
<odoo>
	<template id="report_order_document_ws">
        <t t-call="web.external_layout">
            <t t-set="doc"
               t-value="doc.with_context(lang=doc.partner_id.lang)"/>
            <t t-set="forced_vat" t-value="doc.fiscal_position_id.foreign_vat"/>
            <!-- So that it appears in the footer of the report instead of the company VAT if it's set -->
            <!-- Multicompany -->
            <t t-if="doc and 'company_id' in doc">
                <t t-set="company" t-value="doc.company_id"></t>
            </t>
            <t t-if="not doc or not 'company_id' in doc">
                <t t-set="company" t-value="res_company"></t>
            </t>

            <div class="page" style="font-size: 16pt; font-family: Arial;">
                <div class="oe_structure"/>

                <t t-call="l10n_ru_schet.document_header_table"/>

                <h2 class="mt-4">
                    <span style="font-weight: bold; color: black;">
                        <t t-esc="'Счет на оплату' if doc.state in ['draft','sent'] else 'Счет на оплату'"/>
                        <!-- todo: и if и else возвращают одинаковое значение, зачем они нужны? -->
                        <t t-esc="' № '"/>
                        <t t-esc="doc.name"/>
                        <t t-esc="' от '"/>
                        <t t-esc="doc.date_order"
                           t-options="{'widget': 'date'}"/>
                        <t t-esc="' г.'"/>
                    </span>
                </h2>
                <div style="height: 2px; background-color: black;"></div>
                <div class="oe_structure"/>

                <div class="row mt-4 mb-2" id="informations">
                    <div>
                        <span>
                            <span>Поставщик:</span>
                            <span style="font-weight: bold; margin-left: 50px;">
                                <t t-esc="company.partner_id.get_address_for_schet()"/>
                            </span>
                        </span>
                    </div>
                    <div>
                        <span>
                            <span></span>
                            <span></span>
                        </span>
                    </div>
                </div>
                <div class="row mt-4 mb-2" id="informations">
                    <div>
                        <span>
                            <span>Покупатель:</span>
                            <span style="font-weight: bold; margin-left: 40px;">
                                <t t-esc="doc.partner_id.get_address_for_schet()"/>
                            </span>
                        </span>
                    </div>
                    <div>
                        <span>
                            <span></span>
                            <span></span>
                        </span>
                    </div>
                </div>

                <!-- Is there a discount on at least one line? -->
                <t t-set="lines_to_report"
                   t-value="doc._get_order_lines_to_report()"/>
                <t t-set="display_discount"
                   t-value="any(l.discount for l in lines_to_report)"/>
                <div class="oe_structure"></div>
                <!-- Call main product table -->
                <t t-call="l10n_ru_schet.document_products_table"/>
                <div class="oe_structure"></div>
                <div>
                    <span>
                        Всего наименований
                        <t t-esc="doc.order_line and len(doc.order_line) or '0' "/>
                        , на сумму
                        <t t-esc="doc.amount_total or '0,00'"/>
                        руб.

                    </span>
                </div>
                <div>
                    <span style="font-weight: bold;">
                        <t t-esc="doc.currency_id.amount_to_text(doc.amount_total).replace(',', '')"/>
                    </span>
                </div>
                <br/>
                <br/>
                <div style="height: 2px; background-color: black;"></div>
                <br/>
                <br/>
                <div style="display: flex; flex-wrap: wrap;">
                    <t t-call="l10n_ru_schet.document_signatures_without_stamp"/>
                </div>
            </div>
        </t>
    </template>

	<template id="report_order_raw_ws">
		<t t-call="web.html_container">
			<t t-foreach="docs" t-as="doc">
				<t t-call="l10n_ru_schet.report_order_document_ws" t-lang="doc.partner_id.lang"/></t>
		</t>
	</template>

	<template id="report_order_ws">
		<t t-call="l10n_ru_schet.report_order_raw_ws"/>
	</template>

	<template id="report_saleorder_pro_forma">
		<t t-call="web.html_container">
			<t t-set="is_pro_forma" t-value="True"/>
			<t t-set="docs" t-value="docs.with_context(proforma=True)"/>
			<t t-foreach="docs" t-as="doc">
				<t t-call="sale.report_saleorder_document" t-lang="doc.partner_id.lang"/></t>
		</t>
	</template>

	<!-- Allow edits (e.g. studio) without changing the often inherited base template -->
	<template id="document_tax_totals" inherit_id="account.document_tax_totals_template" primary="True"></template>
</odoo>